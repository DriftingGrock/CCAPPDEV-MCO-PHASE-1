<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Establishment View</title>
    <link rel="stylesheet" href="../../../public/styles/style.css">
    <link rel="stylesheet" href="../../../public/styles/shared_styles/reviews.css">
    <link rel="stylesheet" href="../../../public/styles/morestyles/restoProfile.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://kit.fontawesome.com/b496b1e4d0.js" crossorigin="anonymous"></script>
    <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"> -->

    <style>
        .resto-banner{
            background-image: url("../../../public/images/resto_banner/potato_tower_banner.jpg");
        }
    </style>
</head>

<body>

<!-- header content -->
<div class="header">
    <div class="home">
        <a href="../index.html">ANIMO
            <img style="height: 40px;" src="../../../public/icons/ANIMOEATS_logo.png" alt="jollysnorlax.png" >
            EATS</a>
    </div>
    <div class="navlink"> <a href="../restoList.html">Restaurants</a> </div>
    <div class="profile"><button id="profileBtn"> Log-in <i class="fa fa-solid fa-user"></i></button></div>
</div>

<div id="profileModal" class="modal">
    <div class="modal-content"><b>Existing Profile</b><br>
        <label for="username">
            <input id="username" type="text" placeholder="Username"> <br>
        </label>

        <label for="password">
            <input id="password" type="password" placeholder="Password">
        </label>
        <button id="loginBtn" class="button_dkgreen">Log-in <i class="fa fa-solid fa-user"></i></button>
        <p>Don't have an account yet? <a href="../sign-up.html">Sign-Up</a></p>
    </div>
</div>
<!-- end of header content -->

<script>
    let profileModal = document.getElementById("profileModal");
    let profileBtn = document.getElementById("profileBtn");

    profileBtn.onclick = function() {
        // Show the modal when profile button is clicked
        profileModal.style.display = "flex";
    }

    window.onclick = function(event) {
        // Hide the modal if the click is outside of it
        if (event.target === profileModal) {
            profileModal.style.display = "none";
        }
    }
</script>

<!--Establishment view-->
<main>
    <div class="resto-banner">
        <div class="restaurant-info">
            <h1 class="resto-name">Potato Tower</h1>
            <div class="primary-details">
                <p class="rating">4.5<img class="star-icon" src="../../../public/icons/star.png" alt="star">  (2 reviews)</p>
                <p class="address">2461 G. Masangkay St.</p>
                <p class="phone">üìû0926 115 7638</p>
            </div>
            <div class="supplementary-details">
                <span class="hours">Open 9:00am - 5:00pm</span>
                <span class="price">‚Ç±60</span>
                <span class="cuisine">Fries</span>
            </div>
        </div>
    </div>

    <div class="establishment-tabs">
        <div class="tabs__sidebar">
            <button class="tabs__button" data-for-tab="1"> Overview</button>
            <button class="tabs__button" data-for-tab="2"> Menu</button>
            <button class="tabs__button" data-for-tab="3"> Photos</button>
        </div>

        <div class="tabs__content" data-tab="1">
            <p class="establishment-desc">  Ang Pinakamataas na Patatas! üåüü•î
                Kung mahilig ka sa crispy, golden fries, Potato Tower ang para sa‚Äôyo!
                Dito, hindi lang basta fries ang makukuha mo‚Äîmakakakuha ka ng bundok ng sarap! üåÑü•î
                Isang patong-patong na tower ng mainit, malutong, at malasang fries na siguradong mapapaulit ka.
                At ang pinaka-astig? Puwede mo pang idagdag ang isang malamig at refreshing na iced tea sa napakamurang presyo!
                üßäüçπ Perfect ito para sa barkada, midnight cravings, o simpleng merienda na pasabog sa lasa pero hindi sa bulsa.
                Tara na at tikman ang taas ng sarap sa Potato Tower! üöÄü•î
            </p>

            <section class="rating-graph">
                <div class="rating">
                    <div class="rating__average">
                        <h1> <!--In js script--></h1>
                        <div class="star-outer">
                            <div class="star-inner"> <!--In css--></div>
                        </div>
                        <p>  <!--In js script-->  </p>
                    </div>
                    <div class="rating__progress">
                        <!--In js script-->
                    </div>
                </div>
            </section>

            <section class="reviews-holder">
                <h2>Reviews</h2>
                <div class="star-rating-input"> 
                    <span class="fa fa-star "></span>
                    <span class="fa fa-star "></span>
                    <span class="fa fa-star "></span>
                    <span class="fa fa-star "></span>
                    <span class="fa fa-star "></span>
                </div>
                
                <input class="leave-review-bar" style="font-size: 19.2px; width: auto;" type="text" placeholder="Leave a review..">
                <button id="submit-review" class="button_dkgreen" style="font-size: 19.2px"> submit </button>

                <article class="reviews">
                    <div id="review1" class="review-container">
                        <img class="display-pic" src="../../../public/images/user_profile/Grock.jpg" alt="pfp.jpg">
                        <div class="heading"><a href="../userProfiles/Grock.html">Grock</a></div>
                        <div class="star-rating"><img class="star-icon-review" src="../../../public/icons/star.png" alt="star icon"> 4.0 </div>
                        <div class="description">The powder sauces really made it flavorful! I tried the fries with the iced tea worth!!
                        </div>
                        <div class="date">Jan 27, 2025 17:59</div>
                        <div class="edited">edited</div>
                        <div class="vote">
                            <button class="upvote">
                                <i class="fa-solid fa-up-long"></i>
                            </button>
                            <button class="downvote">
                                <i class="fa-solid fa-down-long"></i>
                            </button>
                        </div>
                    </div>

                    <div id="owner-rep1" class="reply-container">
                        <img class="display-pic" src="../../../public/images/user_profile/Ross.png" alt="pfp.jpg">
                        <div class="heading"> <a href="../userProfiles/Ross.html">Owner</a> </div>
                        <div class="description">Thank you very much, tell a friend!
                        </div>
                        <div class="date">Jan 31, 2021 11:33</div>
                        <div class="vote">
                            <button class="upvote">
                                <i class="fa-solid fa-up-long"></i>
                            </button>
                            <button class="downvote">
                                <i class="fa-solid fa-down-long"></i>
                            </button>
                        </div>
                    </div>

                    <div id="review2" class="review-container">

                        <img class="display-pic" src="../../../public/images/user_profile/Sir_art.png" alt="pfp.jpg">
                        <div class="heading"> <a href="../userProfiles/SirArt.html">Sir Art</a></div>
                        <div class="star-rating"><img class="star-icon-review" src="../../../public/icons/star.png" alt="star icon"> 5.0 </div>
                        <div class="description">Pinakamataas na Patatas!
                        </div>
                        <div class="date">Feb 4, 2025 00:11</div>
                        <div class="vote">
                            <button class="upvote">
                                <i class="fa-solid fa-up-long"></i>
                            </button>
                            <button class="downvote">
                                <i class="fa-solid fa-down-long"></i>
                            </button>
                        </div>
                    </div>
                </article>

            </section>
        </div>

        <div class="tabs__content" data-tab="2">
            <div class="menu-tab">
                <img class="menu-img" src = "../../../public/images/resto_menu/potato_tower_menu.jpg" alt="establishment menu">
            </div>
        </div>

        <div class="tabs__content" data-tab="3">
            <div class="photos-container">
                <div class="photo-gallery">
                    <div class="column">
                        <div class="photo">
                            <img src="../../../public/images/image_gallery/beefchop_noodle.jpg" alt="beefchop_noodle image">
                        </div>
                        <div class="photo">
                            <img src="../../../public/images/image_gallery/yellow.jpg" alt="beefchop_noodle image">
                        </div>
                        <div class="photo">
                            <img src="../../../public/images/image_gallery/colonel_curry.jpg" alt="beefchop_noodle image">
                        </div>
                    </div>

                    <div class="column">
                        <div class="photo">
                            <img src="../../../public/images/image_gallery/indian_foodjpg.jpg" alt="beefchop_noodle image">
                        </div>
                        <div class="photo">
                            <img src="../../../public/images/image_gallery/lasare_food.jpg" alt="beefchop_noodle image">
                        </div>
                        <div class="photo">
                            <img src="../../../public/images/image_gallery/24chicken_sweetcorn.jpg" alt="beefchop_noodle image">
                        </div>
                    </div>

                    <div class="column">
                        <div class="photo">
                            <img src="../../../public/images/image_gallery/panda_siopao.jpg" alt="beefchop_noodle image">
                        </div>
                        <div class="photo">
                            <img src="../../../public/images/image_gallery/cat.jpg" alt="beefchop_noodle image">
                        </div>
                        <div class="photo">
                            <img src="../../../public/images/image_gallery/egg.jpg" alt="beefchop_noodle image">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="../../../public/scripts/profileModal.js"></script>
    <script>
        let data = [
            {
                'star': 5,
                'count': 1,
            },
            {
                'star': 4,
                'count': 1,
            },
            {
                'star': 3,
                'count': 0,
            },
            {
                'star': 2,
                'count': 0,
            },
            {
                'star': 1,
                'count': 0,
            }
        ]

        let total_rating = 0;
        let star_total_rating = 0;
         data.forEach(rating => {
            total_rating += rating.count;
            star_total_rating += rating.count * rating.star;
        });

        data.forEach(rating => {
            let rating__progress = `
                 <div class="rating__progress-value">
                            <p> ${rating.star} <span class="star"> &#9733;</span> </p>
                            <div class="progress">
                                <div class="bar" style="width: ${(rating.count / total_rating) * 100}%;"></div>
                            </div>
                            <p>${rating.count.toLocaleString()}</p>
                </div>
                `;

            document.querySelector('.rating__progress').innerHTML += rating__progress;
        });

        document.querySelector('.rating__average p').innerHTML = total_rating.toLocaleString();

        let star_rating_average = (star_total_rating / total_rating).toFixed(1);
        document.querySelector('.rating__average h1').innerHTML = star_rating_average.toLocaleString();

        let star_display_average = (star_rating_average / 5) * 100;
        document.querySelector('.star-inner').style.width = star_display_average + "%";
    </script>

    <script>
        function setupTabs () {
            document.querySelectorAll(".tabs__button").forEach(button => {
                button.addEventListener("click", () => {
                    const sideBar = button.parentElement;
                    const tabsContainer = sideBar.parentElement;
                    const tabNumber = button.dataset.forTab;
                    const tabToActivate  = tabsContainer.querySelector(`.tabs__content[data-tab="${tabNumber}"]`);

                    console.log(sideBar);
                    console.log(tabsContainer);
                    console.log(tabNumber);
                    console.log(tabToActivate);

                    sideBar.querySelectorAll(".tabs__button").forEach(button => {
                        button.classList.remove("tabs__button--active");
                    });

                    tabsContainer.querySelectorAll(".tabs__content").forEach(tab => {
                        tab.classList.remove("tabs__content--active");
                    });

                    button.classList.add("tabs__button--active");
                    tabToActivate.classList.add("tabs__content--active");
                });
            });
        }

        document.addEventListener("DOMContentLoaded", () => {
            setupTabs();

            document.querySelectorAll(".establishment-tabs").forEach(tabsContainer => {
                tabsContainer.querySelector(".tabs__sidebar .tabs__button").click();
            });
        });

    </script>

</main>
</body>
</html>
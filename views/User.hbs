<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{user.username}} - ANIMO EATS</title>
    <link rel="stylesheet" href="/public/styles/style.css">
    <link rel="stylesheet" href="/public/styles/shared_styles/reviews.css">
    <link rel="stylesheet" href="/public/styles/morestyles/restoProfile.css">
    <link rel="stylesheet" href="/public/styles/morestyles/userProfile.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://kit.fontawesome.com/b496b1e4d0.js" crossorigin="anonymous"></script>
</head>
<body>

{{> header}}  <!-- Reusable header partial -->

<div class="profile-container">
    <div class="section-title">User Profile</div>
    <div class="profile-card">
        <div class="profile-picture" style="background-image: url('{{user.avatar}}');"></div>
        <div class="profile-info">
            <div class="profile-name">{{user.username}}</div>
            <div class="profile-bio">{{user.description}}</div>
        </div>
        <button class="edit-button"><i class="fa fa-pencil"></i></button>
    </div>

    <div class="section-title">Statistics</div>
    <div class="stats-section">
        <div class="reviews-made">
            <div class="reviews-count">{{user.reviews.length}}</div>
            <div>Reviews Made</div>
        </div>
        <div class="reviews-placeholder">
            <div class="reviews-count">{{user.reputation}}</div>
            <div>Reputation</div>
        </div>
    </div>

    <div class="section-title">Recent Reviews</div>
    <article class="reviews">
        {{#each user.reviews}}
        <div class="review-container">
            <img class="display-pic" src="{{../user.avatar}}" alt="profile picture">
            <div class="heading">{{../user.username}}</div>
            <div class="star-rating"><img class="star-icon-review" src="/public/icons/star.png" alt="star icon"> {{this.rating}}</div>
            <div class="establishment">reviewing <a href="/establishment/{{this.establishmentId}}">{{this.establishmentId.name}}</a></div>
            <div class="description">{{this.body}}</div>
            <div class="date">{{this.createdAt}}</div>
            {{#if this.edited}}<div class="edit-tag">edited</div>{{/if}}
            <div class="vote">
                <button class="upvote"><i class="fa-solid fa-up-long"></i></button>
                <button class="downvote"><i class="fa-solid fa-down-long"></i></button>
            </div>
        </div>
        {{/each}}
    </article>
</div>

<script src="/public/scripts/profileModal.js"></script>

<!-- Edit Profile Modal -->
<div id="editProfileModal" class="modal">
    <div class="modal-content">
        <h2>Edit Profile</h2>
        <form id="editProfileForm">
            <div class="form-group">
                <label for="editName">Name:</label>
                <input type="text" id="editName" class="edit-input" value="{{user.username}}">
            </div>
            <div class="form-group">
                <label for="editBio">Bio:</label>
                <textarea id="editBio" class="edit-input" rows="3">{{user.description}}</textarea>
            </div>
            <div class="button-group">
                <button type="submit" class="save-button">Save Changes</button>
                <button type="button" class="cancel-button">Cancel</button>
            </div>
        </form>
    </div>
</div>

<script src="/public/scripts/editProfile.js"></script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{establishment.name}} - Profile</title>
    <link rel="stylesheet" href="/styles/style.css">
    <link rel="stylesheet" href="/styles/shared_styles/reviews.css">
    <link rel="stylesheet" href="/styles/morestyles/restoProfile.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://kit.fontawesome.com/b496b1e4d0.js" crossorigin="anonymous"></script>
</head>
<body>

<div class="header">
    <div class="home">
        <a href="../index.html">ANIMO
            <img style="height: 40px;" src="../../../public/icons/ANIMOEATS_logo.png" alt="jollysnorlax.png" >
            EATS</a>
    </div>
    <div class="navlink"> <a href="../restoList.html">Restaurants</a> </div>
    <div class="profile"><button id="profileBtn"> Log-in <i class="fa fa-solid fa-user"></i></button></div>
</div>

<div id="profileModal" class="modal">
    <div class="modal-content"><b>Existing Profile</b><br>
        <label for="username">
            <input id="username" type="text" placeholder="Username"> <br>
        </label>

        <label for="password">
            <input id="password" type="password" placeholder="Password">
        </label>
        <button id="loginBtn" class="button_dkgreen">Log-in <i class="fa fa-solid fa-user"></i></button>
        <p>Don't have an account yet? <a href="../sign-up.html">Sign-Up</a></p>
    </div>
</div>


<!-- Establishment Banner -->
<div class="resto-banner" style="background-image: url('{{establishment.bannerImage}}');">
    <div class="restaurant-info">
        <h1 class="resto-name">{{establishment.name}}</h1>
        <div class="primary-details">
            <p class="rating">
                {{establishment.overallRating}} 
                <img class="star-icon" src="/icons/star.png" alt="star"> 
                ({{establishment.reviews.length}} reviews)
            </p>
            <p class="address">{{establishment.address}}</p>
            <p class="phone">ðŸ“ž{{establishment.phone}}</p>
        </div>
        <div class="supplementary-details">
            <span class="hours">Open {{establishment.openingHours}}</span>
            <span class="price">â‚±{{establishment.priceRange}}</span>
            <span class="cuisine">{{establishment.cuisine}}</span>
        </div>
    </div>
</div>

<!-- Tabs -->
<div class="establishment-tabs">
    <div class="tabs__sidebar">
        <button class="tabs__button" data-for-tab="1">Overview</button>
        <button class="tabs__button" data-for-tab="2">Menu</button>
        <button class="tabs__button" data-for-tab="3">Photos</button>
    </div>

    <!-- Overview -->
    <div class="tabs__content" data-tab="1">
        <p class="establishment-desc">{{establishment.description}}</p>

        <!-- Rating Section -->
        <section class="rating-graph">
            <div class="rating">
                <div class="rating__average">
                    <h1>{{establishment.overallRating}}</h1>
                    <div class="star-outer">
                        <div class="star-inner" style="width: {{multiply establishment.overallRating 20}}%;"></div>
                    </div>
                    <p>{{establishment.reviews.length}} reviews</p>
                </div>
            </div>
        </section>

        <!-- Reviews -->
        <section class="reviews-holder">
            <h2>Reviews</h2>
            {{#each establishment.reviews}}
                <article class="reviews">
                    <div class="review-container">
                        <img class="display-pic" src="{{this.userId.avatar}}" alt="User image">
                        <div class="heading">
                            <a href="/user/{{this.userId._id}}">{{this.userId.username}}</a>
                        </div>
                        <div class="star-rating">
                            <img class="star-icon-review" src="/icons/star.png" alt="star">
                            {{this.rating}}
                        </div>
                        <div class="description">{{this.body}}</div>
                        <div class="date">{{this.createdAt}}</div>
                        {{#if this.edited}}
                            <div class="edited">edited</div>
                        {{/if}}
                        <div class="vote">
                            <button class="upvote"><i class="fa-solid fa-up-long"></i></button>
                            <button class="downvote"><i class="fa-solid fa-down-long"></i></button>
                        </div>
                    </div>
                </article>
            {{/each}}
        </section>
    </div>

    <!-- Menu -->
    <div class="tabs__content" data-tab="2">
        <div class="menu-tab">
            {{#each menu.items}}
                <img class="menu-img" src="{{this.image}}" alt="{{this.name}}">
            {{/each}}
        </div>
    </div>

    <!-- Photos -->
    <div class="tabs__content" data-tab="3">
        <div class="photos-container">
            <div class="photo-gallery">
                {{#each photos}}
                    <div class="photo">
                        <img src="{{this.imageUrl}}" alt="Gallery Image">
                    </div>
                {{/each}}
            </div>
        </div>
    </div>
</div>

<!-- Tab Switching Script -->
<script>
    document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll(".tabs__button").forEach(button => {
            button.addEventListener("click", () => {
                const tabsContainer = button.closest(".establishment-tabs");
                const tabNumber = button.dataset.forTab;
                const tabToActivate = tabsContainer.querySelector(`.tabs__content[data-tab="${tabNumber}"]`);

                tabsContainer.querySelectorAll(".tabs__button").forEach(btn => btn.classList.remove("tabs__button--active"));
                tabsContainer.querySelectorAll(".tabs__content").forEach(tab => tab.classList.remove("tabs__content--active"));

                button.classList.add("tabs__button--active");
                tabToActivate.classList.add("tabs__content--active");
            });
        });

        // Auto activate the first tab
        document.querySelector('.tabs__button[data-for-tab="1"]').click();
    });
</script>

</body>
</html>
